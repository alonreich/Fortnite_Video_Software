# ==============================================================================
# PROJECT GOAL: Fortnite Video Software
# TARGET: PYTHON / DESKTOP (GPU-ENABLED)
# ==============================================================================
A quick, free-to-use, ad-free, GPU-accelerated desktop video editor designed for creating and sharing cool Fortnite video clips with family and friends.
The suite is divided into four main applications: Video Compressor, Video Merger, Crop Tool, and an Advanced Video Editor.

# General Project Guidelines:
# 1. To maintain readability and focus, each code/script file should not exceed 150-200 lines. Logic should be divided into multiple separate files.
# 2. This file (.\project_structure.txt) must be kept up-to-date, reflecting all changes in the project structure.
# 3. Video tempo and audio pitch scale with the speed multiplier, but background music tempo remains constant.
# 4. To ensure dialogue and in-game sounds are clear, the main video's audio is protected using "Volume Ducking" and "EQ Ducking" against the background music.
#    - Volume Ducking: When the main audio exceeds -16.5 dB (a threshold of 0.15), the background music volume is compressed at a 2.5:1 ratio.
#    - EQ Ducking: The music is split at 150 Hz. Ducking is applied only to frequencies above 150 Hz, preserving the music's bassline while carving out space for the main audio.
# 5. Code should be written without comments for a clean and uncluttered codebase.

# Manual Pip Management:
# To upgrade pip: "%LOCALAPPDATA%\Programs\Python\Python313\python.exe" -m pip install --upgrade pip
# To install packages: "%LOCALAPPDATA%\Programs\Python\Python313\python.exe" -m pip install PyQt5 psutil python-vlc send2trash

# ==============================================================================
# COORDINATE SYSTEM & SCALING LOGIC (CRITICAL FOR AI AGENTS)
# ==============================================================================
# The Crop Tool and Processing Engine usage a unique "Scale-Out" architecture to ensure high quality.
#
# 1. THE UI SPACE (1080x1920):
#    - The Crop Tool's Portrait View operates in a 1080x1920 coordinate space (CONTENT_W=1080).
#    - The Top 150 pixels (y=0 to y=150) are STRICTLY RESERVED for the text/header canvas.
#    - Users are prevented from moving HUD elements into this top area. This is INTENTIONAL.
#    - The configuration file (crops_coordinations.conf) stores coordinates in this 1080p space.
#
# 2. THE PROCESSING SPACE (1280x1920):
#    - The backend (filter_builder.py) scales the main video to 1280x1920 (TARGET_W=1280) first.
#    - This scaling (1280p) is larger than the UI space (1080p).
#    - Why? To allow the 1080p content to be "centered" or manipulated with high fidelity before final output.
#
# 3. THE TRANSFORMATION PIPELINE:
#    - CONFIG -> BACKEND: Coordinates read from config (1080p) must be mapped to the 1280p canvas.
#         a. X_canvas = X_config * BACKEND_SCALE
#         b. Y_canvas = (Y_config - 150) * BACKEND_SCALE
#         c. Element_Size = Size_UI * BACKEND_SCALE (Where Size_UI = Size_Orig * user_scale)
#    - BACKEND -> FFmpeg:
#         a. The *Source Crop* is calculated by INVERTING the 1080p transform back to Original Resolution (e.g. 1920x1080).
#         b. The *Overlay Position* is calculated by scaling the config x,y (1080p) UP to 1280p space.
#         c. The *Element Size* (scale=...) must ALSO be scaled UP to 1280p space to maintain relative size.
#
# 4. KEY TAKEAWAY:
#    - If you see "1080" vs "1280" mismatches, check if it's the UI (1080) vs Backend (1280).
#    - Do NOT remove the "Top Bar" restriction; it protects the text layer.
#    - Do NOT change the scaling logic without understanding the Full Round-Trip (Original -> 1080p Config -> 1280p Canvas -> Final Video).

# ==============================================================================
# PROJECT ARCHITECTURE & FILE ROLE STRUCTURE
# ==============================================================================
.
├── app.py: Main entry point for the application. Launches the main window.
├── README.md: Contains information about the project.
├── project_structure.txt: This file, containing a map and description of the project structure.
├── .gitignore: Specifies files and directories to be ignored by Git.
├── .gitattributes: Specifies attributes for paths.
├── Fix OS Problems.cmd: A command script to fix OS related problems.
├── Installer.ps1: A PowerShell script for one-click installation and updates.
├── z_Install_Fortnite_Video_Software.cmd: A command script to installation.
│
├── !!!_Ouput_Video_Files_!!!/: Default output directory for processed videos.
│
├── advanced/: A separate, multi-track video editor application.
│   ├── (Content from .\advanced\project_structure.txt)
│
├── binaries/: Contains all the necessary binaries for the application to run (ffmpeg, vlc, etc.).
│
├── config/: Contains configuration files for the applications.
│
├── developer_tools/: Tools for development purposes.
│   ├── app_handlers.py: Handles events for the crop tool application.
│   ├── cleaner.py: A script to clean python files by removing comments.
│   ├── config.py: Configuration for the developer tools.
│   ├── crop_tools.py: The main entry point for the crop tool application.
│   ├── crop_widgets.py: Widgets used in the crop tool.
│   ├── Find_and_Remove_Comments.py: A script to find and remove comments from python files.
│   ├── graphics_items.py: Custom graphics items for the crop tool.
│   ├── Keyboard_Mixing.py: A mixin for keyboard shortcuts.
│   ├── logger_setup.py: Sets up the logger for the developer tools.
│   ├── media_processor.py: Processes media for the crop tool.
│   ├── portrait_window.py: The portrait window for the crop tool.
│   ├── ui_setup.py: Sets up the UI for the crop tool.
│   ├── utils.py: Utility functions for the developer tools.
│   ├── audio_compressor.py: Tool for audio compression.
│
├── icons/: Contains application icons.
│   └── Video_Icon_File.ico
│
├── logs/: Directory for application log files.
│
├── mp3/: Directory for background music MP3 files.
│
├── processing/: The core video processing logic.
│   ├── config_data.py: Manages video configuration, crop coordinates, and quality settings.
│   ├── crops_coordinations.conf: Configuration file for external crop coordinates (referenced by config_data.py).
│   ├── encoders.py: Manages hardware/CPU encoder selection and codec flags.
│   ├── filter_builder.py: Constructs complex FFmpeg filter graphs for video/audio processing. Responsible for Volume Ducking + EQ Ducking/Carving.
│   ├── media_utils.py: Utilities for media probing (ffprobe) and bitrate calculations.
│   ├── step_concat.py: Handles the final concatenation of video parts.
│   ├── step_intro.py: Generates the intro sequence for the video.
│   ├── system_utils.py: System-level utilities for subprocess handling, time parsing, and progress monitoring.
│   ├── text_ops.py: Handles text formatting, wrapping, and bidirectional (Hebrew) support.
│   └── worker.py: The central worker thread orchestrating the rendering pipeline.
│
├── system/: System-level modules for the main application.
│   ├── config.py: Manages application configuration.
│   └── logger.py: Sets up the logger for the application.
│
├── ui/: The user interface for the main application.
│   ├── main_window.py: The main window of the application.
│   ├── parts/: Mixins for the main window.
│   │   ├── events_mixin.py: Mixin for handling events.
│   │   ├── ffmpeg_mixin.py: Mixin for handling ffmpeg processes.
│   │   ├── keyboard_mixin.py: Mixin for handling keyboard shortcuts.
│   │   ├── music_mixin.py: Mixin for handling background music.
│   │   ├── phase_overlay_mixin.py: Mixin for handling the processing phase overlay.
│   │   ├── player_mixin.py: Mixin for handling the video player.
│   │   ├── trim_mixin.py: Mixin for handling video trimming.
│   │   ├── ui_builder_mixin.py: Mixin for building the UI.
│   │   └── volume_mixin.py: Mixin for handling volume controls.
│   └── widgets/: Custom widgets for the UI.
│       ├── clickable_button.py: A button with a custom click event.
│       ├── custom_file_dialog.py: A custom file dialog.
│       ├── draggable_list_widget.py: A list widget with drag and drop functionality.
│       ├── drop_area.py: A frame that accepts file drops.
│       ├── music_offset_dialog.py: A dialog for setting the music offset.
│       ├── portrait_mask_overlay.py: An overlay for the portrait mode.
│       ├── slider_container.py: A container for the timeline slider.
│       ├── timeline_slider.py: A custom slider for the timeline.
│       ├── tooltip_manager.py: Manages tooltips for widgets.
│       └── trimmed_slider.py: A slider with trim handles.
│
└── utilities/: The Video Merger application.
    ├── merger_ffmpeg_process.py: Handles the ffmpeg process for the merger.
    ├── merger_ffmpeg.py: The main ffmpeg handler for the merger.
    ├── merger_handlers_buttons.py: Handlers for the buttons in the merger.
    ├── merger_handlers_dialogs.py: Handlers for the dialogs in the merger.
    ├── merger_handlers_list.py: Handlers for the list widget in the merger.
    ├── merger_handlers_main.py: The main event handler for the merger.
    ├── merger_handlers_preview.py: Handlers for the preview in the merger.
    ├── merger_music_dialog.py: The music dialog for the merger.
    ├── merger_phase_overlay_mixin.py: A mixin for handling the processing phase overlay in the merger.
    ├── merger_ui_badge.py: The badge for the UI in the merger.
    ├── merger_ui_build.py: Builds the UI for the merger.
    ├── merger_ui_main.py: The main UI for the merger.
    ├── merger_ui_overlay.py: The overlay for the UI in the merger.
    ├── merger_ui_style.py: The style for the UI in the merger.
    ├── merger_ui_widgets.py: Widgets for the UI in the merger.
    ├── merger_ui.py: The main UI module for the merger.
    ├── merger_utils.py: Utility functions for the merger.
    ├── merger_window_logic.py: The logic for the merger window.
    ├── merger_window.py: The main window for the merger.
    └── video_merger.py: Main entry point for the Video Merger application.